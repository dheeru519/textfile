pipeline 
{
    agent any 
    options { 
        disableConcurrentBuilds() 
        buildDiscarder(logRotator(numToKeepStr: '20', daysToKeepStr: '10'))
    }
    parameters {
        string(name: 'BuildNo', defaultValue: '1.0.$BUILD_NUMBER.0', description: 'Build Number')
    }
    stages {

        stage('MongoDB Backup Creation') {
		steps {
				script
				{
  				    bat'''
					SET HTTPS_PROXY=http://servproxy.carcgl.com:80
					echo "Create a DBBackup"
					cd "E:\\DBBackup\\MongoDB\\backup"
					mongodump --uri="mongodb+srv://dbUser:Nfs5YEyvdZJgiqxk@cluster0.ozth0.mongodb.net/dPDR_Qa" & ren dump dump_%date:~10,4%%date:~7,2%%date:~4,2%-%time:~0,2%%time:~3,2%
					if %errorlevel% neq 0 exit /b %errorlevel%
					echo "Mongodb backup created successfully" '''
				}
        	}
    	}
    }
}
